<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Elevated Auto Wraps | San Antonio Vehicle Customization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:ital,wght@1,900&family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
      :root {
        --purple-neon: #a855f7;
        --purple-light: #e9d5ff;
      }
      body {
        font-family: 'Inter', sans-serif;
        background-color: #08070b;
        background-image: 
          radial-gradient(circle at 20% 0%, rgba(255, 255, 255, 0.15) 0%, transparent 40%),
          radial-gradient(circle at 80% 20%, rgba(168, 85, 247, 0.2) 0%, transparent 50%),
          radial-gradient(circle at 50% 100%, rgba(233, 213, 255, 0.15) 0%, transparent 60%),
          linear-gradient(to bottom, #08070b 0%, #0c0b14 100%);
        color: #fff;
        margin: 0;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        /* scroll-behavior handled by GSAP — CSS smooth-scroll conflicts with pin/scrub */
      }
      .porsche-font {
        font-family: 'Archivo', sans-serif;
        font-weight: 900;
        font-style: italic;
        text-transform: uppercase;
        letter-spacing: -0.05em;
      }
      .bg-aura-purple {
        background: radial-gradient(circle at 50% 50%, rgba(168, 85, 247, 0.25) 0%, transparent 70%);
      }
      .bg-aura-white {
        background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.12) 0%, transparent 70%);
      }
      .bg-mesh {
        background-image: 
          radial-gradient(at 0% 0%, rgba(255, 255, 255, 0.05) 0px, transparent 50%),
          radial-gradient(at 100% 0%, rgba(168, 85, 247, 0.1) 0px, transparent 50%),
          radial-gradient(at 100% 100%, rgba(255, 255, 255, 0.05) 0px, transparent 50%),
          radial-gradient(at 0% 100%, rgba(168, 85, 247, 0.1) 0px, transparent 50%);
        background-size: cover;
      }
      .glass-panel {
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .btn-solid { 
            position: relative;
            background: transparent !important;
            color: #a855f7 !important; 
            padding: 18px 45px; 
            font-weight: 800; 
            display: inline-flex;
            align-items: center;
            justify-content: center;
            text-decoration: none !important;
            cursor: pointer;
            border-radius: 9999px;
            overflow: hidden;
            border: 1px solid rgba(168, 85, 247, 0.1);
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(168, 85, 247, 0.1);
            z-index: 1;
        }

        .btn-solid::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400%; 
            height: 400%;
            background: conic-gradient(
                from 0deg at 50% 50%,
                transparent 50%,
                #a855f7 70%,
                #ffffff 100%
            );
            z-index: -2;
            opacity: 0;
            transition: opacity 0.3s ease;
            will-change: transform;
        }

        .btn-solid::after {
            content: "";
            position: absolute;
            inset: 3px; 
            background: #ffffff;
            border-radius: 9999px;
            z-index: -1;
        }

        .btn-solid:hover::before {
           opacity: 1; 
           animation: borderRotate 2s linear infinite;
        }

        .btn-solid:hover {
            transform: scale(1.05);
            color: #7e22ce !important;
            box-shadow: 0 0 50px rgba(168, 85, 247, 0.7); 
            border-color: transparent;
        }
        
        .btn-solid span {
            position: relative;
            z-index: 10;
        }

        @keyframes borderRotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
      
    /* Epic Ken Burns Effect */
    @keyframes epicZoom {
      0% { transform: scale(1); }
      100% { transform: scale(1.1); }
    }
    .ken-burns {
      animation: epicZoom 15s ease-in-out infinite alternate;
      will-change: transform;
    }
    </style>
    <!-- GSAP and ScrollTrigger -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script src="navbar.js"></script>
</head>
<body class="bg-[#08070b] text-white antialiased">
  <!-- Preloader -->
  <div id="preloader" class="fixed inset-0 z-[9999] bg-black flex flex-col items-center justify-center overflow-hidden transition-opacity duration-700">
    <div class="relative flex flex-col items-center">
      <img src="https://ogautocc.com/ElevatedWraps/Elevated_preloader.GIF" class="h-32 md:h-48 w-auto mb-8" alt="Elevated Wraps Loading...">
      <div class="w-48 h-[1px] bg-zinc-900 relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-purple-500 to-transparent w-full h-full animate-[loading_1.5s_ease-in-out_infinite] -translate-x-full"></div>
      </div>
    </div>
    <div class="mt-12 overflow-hidden">
      <span class="porsche-font text-[10px] tracking-[1em] text-zinc-500 block animate-pulse">
        PREPARING EXCELLENCE
      </span>
    </div>
  </div>
  <style>
    @keyframes loading {
      0% { transform: translateX(-100%); }
      50% { transform: translateX(100%); }
      100% { transform: translateX(100%); }
    }
  </style>
  <script>
    // Immediate check to prevent flash on repeat visits
    if (sessionStorage.getItem('elevated_preloader_shown')) {
      const preloader = document.getElementById('preloader');
      if (preloader) preloader.style.display = 'none';
    } else {
      // Lock scroll while preloader is active
      document.body.style.overflow = 'hidden';
      // Fallback: Force remove preloader after 10s if load hangs
      setTimeout(() => {
        const preloader = document.getElementById('preloader');
        if (preloader && preloader.style.display !== 'none') {
          preloader.style.opacity = '0';
          setTimeout(() => {
            preloader.style.display = 'none';
            document.body.style.overflow = '';
            sessionStorage.setItem('elevated_preloader_shown', 'true');
          }, 700);
        }
      }, 10000);
    }

    window.addEventListener('load', function() {
      const preloader = document.getElementById('preloader');
      // Only run animation if preloader is still visible
      if (preloader && preloader.style.display !== 'none') {
        const loadingTime = 4000;
        setTimeout(() => {
          preloader.style.opacity = '0';
          setTimeout(() => {
            preloader.style.display = 'none';
            document.body.style.overflow = '';
            sessionStorage.setItem('elevated_preloader_shown', 'true');
          }, 700);
        }, loadingTime);
      }
    });
  </script>

  <div id="navbar-container"></div>
  <main>
    <!-- 1. MAIN HERO SECTION (Video Background + Text) -->
    <div class="hero-wrapper relative min-h-screen flex items-center justify-center overflow-hidden">
      <!-- Background Video -->
      <video autoplay loop muted playsinline preload="metadata" class="absolute inset-0 w-full h-full object-cover opacity-50 z-0 pointer-events-none">
        <source src="Services_Hero_video.mp4" type="video/mp4">
      </video>
      <!-- Dark Overlay to make text pop -->
      <div class="absolute inset-0 bg-black/60 z-1 pointer-events-none"></div>

      <!-- Hero Content -->
      <div class="relative z-10 max-w-7xl mx-auto px-6 flex flex-col items-center justify-center h-full text-center mt-20">
            <!-- Small Tagline above title similar to reference -->
            <p class="hero-tagline text-xs md:text-sm font-bold tracking-[0.5em] text-purple-400 mb-4 uppercase opacity-0 translate-y-10">
                PRECISION • CREATIVITY • PREMIUM MATERIALS
            </p>
            
            <!-- Massive Statement Title -->
            <h1 class="hero-title porsche-font text-7xl md:text-[10rem] leading-[0.8] text-white tracking-tight italic mb-12 opacity-0 translate-y-10">
                OUR <span class="text-[#a855f7]">SERVICES.</span>
            </h1>

            <!-- Description Text -->
            <div class="hero-desc space-y-6 text-zinc-100 text-lg md:text-xl font-light leading-relaxed max-w-3xl mx-auto drop-shadow-md opacity-0 translate-y-10">
                <p>At Elevated Auto Wraps, every project is a blend of precision, creativity, and premium materials.</p>
                <p>Whether you’re looking to protect your investment, change your vehicle’s look, or create a one-of-a-kind design, we’ve got you covered.</p>
            </div>
      </div>
      
      <!-- Scroll Down Indicator -->
      <div class="scroll-indicator absolute bottom-10 left-1/2 -translate-x-1/2 z-10 animate-bounce text-white/50">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
        </svg>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        gsap.registerPlugin(ScrollTrigger);
        
        // Pin the hero section and fade in content on scroll
        const heroTimeline = gsap.timeline({
          scrollTrigger: {
            trigger: ".hero-wrapper", 
            start: "top top",
            end: "+=100%", // Scroll distance to complete animation
            pin: true,     // Pin the section
            scrub: 1,      // Smooth scrubbing
            // markers: true // Uncomment for debugging
          }
        });

        // Animate elements sequentially
        heroTimeline
          .to(".hero-tagline", { opacity: 1, y: 0, duration: 1 })
          .to(".hero-title", { opacity: 1, y: 0, duration: 1 }, "-=0.5")
          .to(".hero-desc", { opacity: 1, y: 0, duration: 1 }, "-=0.5");
          
        // Ensure scroll down indicator fades out as we scroll
        gsap.to(".scroll-indicator", {
            scrollTrigger: {
                trigger: ".hero-wrapper",
                start: "top top",
                end: "20% top",
                scrub: true
            },
            opacity: 0
        });
      });
    </script>

    <!-- 2. SERVICES GALLERY SECTION (Unicorn Title + Cards) -->
    <div class="bg-black relative">
      <!-- Background Effects (clipped to prevent horizontal overflow) -->
      <!-- NOTE: On mobile, these large blur elements are hidden to save GPU memory -->
      <div class="absolute inset-0 overflow-hidden pointer-events-none z-0 hidden md:block">
        <div class="absolute inset-0 bg-mesh opacity-50"></div>
        <div class="absolute top-0 left-1/4 w-[1200px] h-[1200px] bg-purple-500/15 blur-[300px] rounded-full"></div>
        <div class="absolute top-1/2 -right-[500px] w-[1000px] h-[1000px] bg-white/10 blur-[300px] rounded-full"></div>
        <div class="absolute -bottom-[400px] -left-[400px] w-[800px] h-[800px] bg-purple-300/10 blur-[250px] rounded-full"></div>
      </div>
      <!-- Mobile: lighter background effect -->
      <div class="absolute inset-0 overflow-hidden pointer-events-none z-0 block md:hidden">
        <div class="absolute inset-0 bg-mesh opacity-30"></div>
        <div class="absolute top-1/4 left-1/4 w-[300px] h-[300px] bg-purple-500/10 blur-[100px] rounded-full"></div>
      </div>

      <!-- ═══════════════════════════════════════════════════════
           UNICORN TITLE REVEAL — Scroll-driven clip-path animation
           Uses an expanding circle clip-path to reveal the Unicorn
           embed at full native resolution — no CSS scaling, no
           pixelation. The embed always renders at 100% quality.
           
           MOBILE: Unicorn Studio WebGL is disabled to prevent
           GPU memory crashes. A lightweight CSS fallback is
           shown instead with a scale zoom animation.
           ═══════════════════════════════════════════════════════ -->
      <style>
        /* Desktop: Unicorn embed stays at native viewport size — NO scaling.
           The clip-path handles the reveal so the WebGL canvas is always crisp. */
        #title-zoom-inner {
          width: 100%;
          height: 100%;
          transform-origin: center center;
          will-change: clip-path, opacity;
          /* Start fully clipped (invisible) — GSAP animates the clip-path */
          clip-path: circle(0% at 50% 50%);
          opacity: 0;
        }

        /* The Unicorn embed fills the sticky container */
        #unicorn-embed-container {
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        /* The actual Unicorn project div — centered at native 1920×850 */
        #unicorn-embed-container > [data-us-project] {
          width: 1920px;
          height: 850px;
          flex-shrink: 0;
        }

        /* ── Mobile CSS Fallback Title ── */
        #title-zoom-fallback {
          display: none; /* hidden by default — shown on mobile via JS */
          width: 100%;
          height: 100%;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          text-align: center;
          gap: 0.5rem;
          transform-origin: center center;
          backface-visibility: hidden;
          -webkit-backface-visibility: hidden;
        }
        #title-zoom-fallback .fallback-line {
          font-family: 'Archivo', sans-serif;
          font-weight: 900;
          font-style: italic;
          text-transform: uppercase;
          letter-spacing: -0.03em;
          line-height: 0.85;
          background: linear-gradient(135deg, #ffffff 0%, #a855f7 50%, #e9d5ff 100%);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
        }
        #title-zoom-fallback .fallback-line:first-child {
          font-size: clamp(2.5rem, 12vw, 5rem);
        }
        #title-zoom-fallback .fallback-line:last-child {
          font-size: clamp(2rem, 10vw, 4rem);
          opacity: 0.7;
        }

        /* Mobile: reduce scroll height since animation is lighter */
        @media (max-width: 768px) {
          #title-zoom-section {
            height: 200vh !important;
          }
        }
      </style>
      <div id="title-zoom-section" class="relative z-10" style="height: 300vh;">
        <div id="title-zoom-pin" class="sticky top-0 w-full h-screen flex items-center justify-center overflow-hidden">
          <!-- Desktop: Unicorn Studio WebGL title (hidden on mobile) -->
          <div id="title-zoom-inner">
            <div id="unicorn-embed-container">
              <div data-us-project="cb1pg5ymSzmJuCnPEkTP" style="width: 1920px; height: 850px;"></div>
            </div>
          </div>
          <!-- Mobile: Lightweight CSS fallback title -->
          <div id="title-zoom-fallback" style="transform: scale(0.5); opacity: 0;">
            <span class="fallback-line">WHAT WE</span>
            <span class="fallback-line">OFFER</span>
          </div>
        </div>
      </div>
      <script>
        // Load Unicorn Studio on all devices (needed for footer social icons).
        // On mobile, only the large title embed is removed to save GPU memory.
        (function() {
          var isMobileDevice = window.innerWidth <= 768;

          // Mobile: remove the large title WebGL embed to free GPU memory
          if (isMobileDevice) {
            var embed = document.getElementById('unicorn-embed-container');
            if (embed) embed.remove();
            // Show fallback
            var fallback = document.getElementById('title-zoom-fallback');
            if (fallback) fallback.style.display = 'flex';
            // Hide the desktop inner wrapper
            var inner = document.getElementById('title-zoom-inner');
            if (inner) inner.style.display = 'none';
          }

          // Load Unicorn Studio library on ALL devices (for footer social icons)
          var u = window.UnicornStudio;
          if (u && u.init) {
            if (document.readyState === "loading") {
              document.addEventListener("DOMContentLoaded", function(){ u.init(); });
            } else {
              u.init();
            }
          } else {
            window.UnicornStudio = { isInitialized: false };
            var i = document.createElement("script");
            i.src = "https://cdn.jsdelivr.net/gh/hiunicornstudio/unicornstudio.js@v2.0.5/dist/unicornStudio.umd.js";
            i.onload = function() {
              if (document.readyState === "loading") {
                document.addEventListener("DOMContentLoaded", function(){ UnicornStudio.init(); });
              } else {
                UnicornStudio.init();
              }
            };
            (document.head || document.body).appendChild(i);
          }
        })();
      </script>
      
      <section class="offer-section relative pt-32 md:pt-48 pb-20 md:pb-24 bg-transparent z-10">
        <style>
          /* ============================================================
             PORSCHE-INSPIRED EXPANDING CARD GALLERY
             Hardware-accelerated: uses only transform & opacity
             Easing: cubic-bezier(0.4, 0, 0.2, 1) — premium weighted feel
             ============================================================ */

          .gallery-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.25rem;
            align-items: start;
          }
          @media (min-width: 640px) {
            .gallery-grid { grid-template-columns: repeat(2, 1fr); }
          }
          @media (min-width: 1024px) {
            .gallery-grid { grid-template-columns: repeat(4, 1fr); }
          }

          .gallery-card {
            position: relative;
            aspect-ratio: 4 / 3;
            overflow: hidden;
            border-radius: 1.25rem;
            cursor: pointer;
            background: #0a0a0a;
            border: 1px solid rgba(124, 58, 237, 0.15);
            transform: translateZ(0);
            transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1),
                        border-color 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                        box-shadow 0.5s cubic-bezier(0.4, 0, 0.2, 1);
          }
          @media (min-width: 640px) {
            .gallery-card { aspect-ratio: 3 / 4; }
          }
          .gallery-card:hover {
            transform: translateY(-12px) translateZ(0);
            border-color: #a78bfa;
            box-shadow: 0 20px 60px -10px rgba(124, 58, 237, 0.4);
            will-change: transform;
          }

          /* Image scaled 110% for parallax headroom */
          .gallery-card .card-img {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scale(1.15) translateZ(0);
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1), filter 0.6s ease;
            filter: grayscale(0.3);
          }
          .gallery-card:hover .card-img {
            filter: grayscale(0);
            will-change: transform;
          }

          .gallery-card .card-scrim {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.92) 0%, rgba(0,0,0,0.5) 35%, rgba(0,0,0,0.1) 60%, transparent 100%);
            z-index: 2;
            pointer-events: none;
          }

          .gallery-card .card-content {
            position: absolute;
            bottom: 0; left: 0; right: 0;
            padding: 2rem 4.5rem 2rem 1.5rem;
            z-index: 3;
            transform: translateY(0) translateZ(0);
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
          }
          .gallery-card:hover .card-content { transform: translateY(-8px) translateZ(0); }

          .gallery-card .card-label {
            font-size: 9px; font-weight: 800;
            text-transform: uppercase; letter-spacing: 0.35em;
            color: #a855f7; margin-bottom: 0.5rem;
            opacity: 0; transform: translateY(8px);
            transition: opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1), transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
          }
          .gallery-card:hover .card-label { opacity: 1; transform: translateY(0); }

          .gallery-card .card-name { font-size: 1.5rem; line-height: 1; }
          @media (min-width: 768px) { .gallery-card .card-name { font-size: 1.75rem; } }

          .card-plus {
            position: absolute; bottom: 1.25rem; right: 1.25rem;
            width: 44px; height: 44px;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            z-index: 5; border: none;
            transform: scale(1) rotate(0deg) translateZ(0);
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.4s ease;
          }
          .card-plus svg { width: 18px; height: 18px; stroke: #000; transition: stroke 0.3s ease; }
          .gallery-card:hover .card-plus { transform: scale(1.15) rotate(90deg) translateZ(0); background: #7c3aed; }
          .gallery-card:hover .card-plus svg { stroke: #fff; }

          /* Light-sweep on hover */
          .gallery-card::after {
            content: ''; position: absolute; top: 0; left: -100%;
            width: 60%; height: 100%;
            background: linear-gradient(105deg, transparent 30%, rgba(255,255,255,0.08) 50%, transparent 70%);
            z-index: 4; pointer-events: none;
            transform: skewX(-15deg) translateZ(0);
            transition: left 0s 0.9s; /* instant reset after hover-out delay */
          }
          .gallery-card:hover::after {
            left: 160%;
            transition: left 0.9s cubic-bezier(0.4, 0, 0.2, 1);
          }

          /* ============================================================
             FULLSCREEN MODAL — Porsche-style contained image
             ALL animations are driven by GSAP (no CSS transitions)
             so the FLIP expansion, scrim, text, and UI reveals
             are on one synchronised timeline.
             ============================================================ */
          .gallery-modal {
            position: fixed; inset: 0; z-index: 11000;
            display: flex; align-items: center; justify-content: center;
            pointer-events: none; visibility: hidden;
            touch-action: pan-x;
          }
          .gallery-modal.is-open { pointer-events: auto; visibility: visible; }

          /* Dark backdrop with blur — opacity controlled by GSAP */
          .gallery-modal .modal-scrim {
            position: absolute; inset: 0;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            opacity: 0;
          }
          /* Reduce blur on mobile to save GPU memory */
          @media (max-width: 768px) {
            .gallery-modal .modal-scrim {
              backdrop-filter: none; -webkit-backdrop-filter: none;
              background: rgba(0,0,0,0.92);
            }
          }

          /* Contained image frame — opacity/transform controlled by GSAP */
          .modal-frame {
            position: relative; z-index: 10;
            width: 90vw; max-width: 1200px;
            height: 70vh; max-height: 740px;
            border-radius: 0.75rem; overflow: hidden;
            box-shadow: 0 40px 100px -20px rgba(0,0,0,0.7);
            opacity: 0;
            will-change: transform, opacity;
            touch-action: pan-y pinch-zoom;
          }

          /* ── Slide track — horizontal carousel clipped by frame ── */
          .modal-slide-track {
            position: absolute; inset: 0;
            width: 100%; height: 100%;
            background: #000; /* solid black hides gaps during high-velocity phase */
          }
          .modal-slide {
            position: absolute; inset: 0;
            width: 100%; height: 100%;
            overflow: hidden;  /* clips the oversized image for parallax */
            will-change: transform, opacity;
          }
          .modal-slide .modal-img {
            position: absolute;
            top: -5%; left: -5%;
            width: 110%; height: 110%;
            object-fit: cover;
            will-change: transform;
          }

          /* Bottom gradient scrim over image for text readability */
          .modal-frame .modal-img-scrim {
            position: absolute; inset: 0;
            background: linear-gradient(
              to top,
              rgba(0,0,0,0.85) 0%,
              rgba(0,0,0,0.55) 25%,
              rgba(0,0,0,0.15) 50%,
              transparent 70%
            );
            z-index: 2; pointer-events: none;
            opacity: 0; /* fades in with GSAP after expansion */
          }

          /* Text content anchored bottom-left */
          .modal-frame .modal-text {
            position: absolute;
            bottom: 0; left: 0; right: 0;
            padding: 1.5rem 1.25rem;
            z-index: 3;
          }
          @media (min-width: 768px) {
            .modal-frame .modal-text { padding: 3rem 3.5rem; max-width: 65%; }
          }

          /* ── "Angled Pocket Reveal" — 3D Masked Skew-Transform ── */
          /* Each text line sits in a perspective-enabled pocket.
             Text swings up from below on a hinge, tilted and skewed,
             then flattens into its final resting position.
             clip-path used instead of overflow:clip so 3D transforms
             (rotateX, skewY) are not flattened by the overflow context. */
          .modal-text-mask {
            position: relative;
            perspective: 1000px;
            transform-style: preserve-3d;
            /* Expanded clip-path to prevent cutting off skewed text, especially on mobile */
            clip-path: inset(-10% -20% -15% -20%);
            padding-bottom: 0.15em;
          }
          .modal-title-words {
            display: flex;
            flex-wrap: wrap;
            gap: 0 0.3em;
            transform-origin: center bottom;
            transform-style: preserve-3d;
            will-change: transform, opacity;
          }
          .modal-title-word {
            display: inline-block;
            transform-origin: center bottom;
            will-change: transform, opacity;
            backface-visibility: hidden;
          }

          /* Nav arrows — opacity controlled by GSAP */
          .modal-nav-btn {
            position: absolute; top: 50%; transform: translateY(-50%); z-index: 20;
            color: rgba(255,255,255,0.5); padding: 0.75rem; border-radius: 50%;
            background: rgba(255,255,255,0.06); border: none; cursor: pointer;
            opacity: 0;
            transition: color 0.3s ease, background-color 0.3s ease;
          }
          .modal-nav-btn:hover { color: #fff; background: rgba(255,255,255,0.12); }
          .modal-nav-btn.prev { left: 1rem; }
          .modal-nav-btn.next { right: 1rem; }
          @media (min-width: 1400px) {
            .modal-nav-btn.prev { left: calc(50% - 650px); }
            .modal-nav-btn.next { right: calc(50% - 650px); }
          }
          .modal-nav-btn svg { width: 2rem; height: 2rem; transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
          @media (min-width: 768px) { .modal-nav-btn svg { width: 2.5rem; height: 2.5rem; } }
          .modal-nav-btn.prev:hover svg { transform: translateX(-3px); }
          .modal-nav-btn.next:hover svg { transform: translateX(3px); }
          /* Dim arrows during carousel transition */
          .modal-nav-btn.is-transitioning {
            opacity: 0.25 !important;
            pointer-events: none;
          }

          /* Close button — opacity controlled by GSAP */
          .modal-close-btn {
            position: absolute; top: 1.25rem; right: 1.25rem; z-index: 20;
            display: flex; align-items: center; gap: 0.5rem;
            color: white; padding: 0.5rem 0.75rem 0.5rem 1rem;
            border-radius: 9999px; background: rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            cursor: pointer;
            opacity: 0;
            transition: border-color 0.3s ease, color 0.3s ease;
          }
          .modal-close-btn:hover { color: #c084fc; border-color: rgba(168,85,247,0.5); }
          .modal-close-btn span { font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.15em; }
          @media (max-width: 767px) { .modal-close-btn span { display: none; } }
        </style>
        <!-- Unicorn Studio Title moved to zoom section above -->

        <div class="max-w-[1400px] mx-auto px-6 relative z-10">
          <div class="gallery-grid" id="gallery-grid">
            <!-- Card 1 — Paint Protection Film -->
            <div class="gallery-card" data-index="0">
              <img class="card-img" src="https://ogautocc.com/ElevatedWraps/Paint_Protection_Film.jpg" alt="Paint Protection Film" loading="lazy" decoding="async">
              <div class="card-scrim"></div>
              <div class="card-content">
                <div class="card-label">Preserve &amp; Protect</div>
                <h3 class="card-name porsche-font text-white italic leading-none drop-shadow-lg">Paint Protection Film</h3>
              </div>
              <button class="card-plus" aria-label="View Paint Protection Film details">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round"><path d="M12 5v14M5 12h14"/></svg>
              </button>
            </div>
            <!-- Card 2 — Vinyl Wraps -->
            <div class="gallery-card" data-index="1">
              <img class="card-img" src="https://ogautocc.com/ElevatedWraps/Vinyl_wraps.jpg" alt="Vinyl Wraps" loading="lazy" decoding="async">
              <div class="card-scrim"></div>
              <div class="card-content">
                <div class="card-label">Transform &amp; Express</div>
                <h3 class="card-name porsche-font text-white italic leading-none drop-shadow-lg">Vinyl Wraps</h3>
              </div>
              <button class="card-plus" aria-label="View Vinyl Wraps details">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round"><path d="M12 5v14M5 12h14"/></svg>
              </button>
            </div>
            <!-- Card 3 — Window Tint -->
            <div class="gallery-card" data-index="2">
              <img class="card-img" src="https://ogautocc.com/ElevatedWraps/Window_tint.JPG" alt="Window Tint" loading="lazy" decoding="async">
              <div class="card-scrim"></div>
              <div class="card-content">
                <div class="card-label">Style &amp; Comfort</div>
                <h3 class="card-name porsche-font text-white italic leading-none drop-shadow-lg">Window Tint</h3>
              </div>
              <button class="card-plus" aria-label="View Window Tint details">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round"><path d="M12 5v14M5 12h14"/></svg>
              </button>
            </div>
            <!-- Card 4 — Auto Detail -->
            <div class="gallery-card" data-index="3">
              <img class="card-img" src="https://ogautocc.com/ElevatedWraps/Auto_Detail.jpg" alt="Auto Detail" loading="lazy" decoding="async">
              <div class="card-scrim"></div>
              <div class="card-content">
                <div class="card-label">Refresh &amp; Restore</div>
                <h3 class="card-name porsche-font text-white italic leading-none drop-shadow-lg">Auto Detail</h3>
              </div>
              <button class="card-plus" aria-label="View Auto Detail details">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round"><path d="M12 5v14M5 12h14"/></svg>
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- ═══════════════════════════════════════════════════════════════
           ULTRA-PREMIUM PARALLAX CTA — Layered Depth with Floating Text
           ═══════════════════════════════════════════════════════════════ -->
      <section id="svc-parallax-cta" class="relative w-full" style="height: 200vh;">

        <!-- LAYER 1: Sticky Background -->
        <div class="sticky top-0 w-full h-screen overflow-hidden">

          <!-- Background Image — slow parallax via GSAP -->
          <div id="svc-parallax-bg" class="absolute inset-0 w-full h-full will-change-transform" style="transform: scale(1.15);">
            <img 
              src="https://images.squarespace-cdn.com/content/v1/67053ead069230112a5e9280/15a2f83f-a017-4178-9273-17f19da9677a/unsplash-image-ZNkiEWL02mI.jpg?format=2500w" 
              alt="Tailored Excellence Background" 
              class="w-full h-full object-cover"
              loading="lazy" decoding="async"
            />
          </div>

          <!-- Dark Cinematic Overlays -->
          <div class="absolute inset-0 bg-black/55 pointer-events-none"></div>
          <div class="absolute inset-0 bg-gradient-to-b from-[#08070b] via-transparent to-[#08070b] pointer-events-none"></div>
          <div class="absolute inset-0 bg-gradient-to-r from-black/30 via-transparent to-black/30 pointer-events-none"></div>

          <!-- Subtle purple atmospheric glow -->
          <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-purple-600/10 blur-[200px] rounded-full pointer-events-none"></div>

        </div>

        <!-- LAYER 2: Floating Content -->
        <div class="relative z-10" style="margin-top: -100vh;">
          
          <!-- First viewport: clean open — just the image breathing -->
          <div class="h-[40vh]"></div>

          <!-- Floating Text Block -->
          <div class="min-h-[120vh] flex flex-col items-center justify-center px-6">
            <div class="max-w-5xl mx-auto text-center space-y-10">

              <!-- Eyebrow -->
              <div class="svc-parallax-float overflow-hidden" data-speed="1.2">
                <span class="inline-block text-purple-400 text-[10px] md:text-xs uppercase tracking-[0.6em] md:tracking-[0.8em] font-black opacity-0 translate-y-8" id="svc-cta-eyebrow">
                  Curated Consultations • Maximum Impact
                </span>
              </div>

              <!-- Main Headline — staggered reveal -->
              <div class="svc-parallax-float space-y-2" data-speed="0.8">
                <h3 class="porsche-font text-[clamp(2.2rem,8vw,7rem)] leading-[0.85] text-white tracking-tighter opacity-0 translate-y-12" id="svc-cta-headline-1">
                  TAILORED
                </h3>
                <h3 class="porsche-font text-[clamp(2.2rem,8vw,7rem)] leading-[0.85] text-purple-500 tracking-tighter opacity-0 translate-y-12" id="svc-cta-headline-2">
                  EXCELLENCE.
                </h3>
              </div>

              <!-- Thin Divider -->
              <div class="svc-parallax-float flex justify-center" data-speed="1.0">
                <div class="w-16 h-[1px] bg-purple-500/60 opacity-0 scale-x-0" id="svc-cta-divider"></div>
              </div>

              <!-- Supporting Copy -->
              <div class="svc-parallax-float" data-speed="0.6">
                <p class="text-white text-lg md:text-xl max-w-2xl mx-auto leading-relaxed font-light italic opacity-0 translate-y-8" id="svc-cta-body">
                  Our specialists provide curated consultations to ensure your vehicle receives exactly what it needs for maximum preservation and aesthetic impact.
                </p>
              </div>

              <!-- CTA Buttons -->
              <div class="svc-parallax-float pt-4" data-speed="0.4">
                <div class="flex flex-col sm:flex-row items-center justify-center gap-6 md:gap-8 opacity-0 translate-y-8" id="svc-cta-buttons">
                  <a href="tel:2102014999" class="btn-solid py-5 md:py-6 px-10 md:px-14 text-[10px] md:text-xs tracking-[0.5em] rounded-full uppercase font-black w-full sm:w-auto text-center transition-all duration-500">Direct Line</a>
                  <a href="quote.html" class="btn-solid py-5 md:py-6 px-10 md:px-14 text-[10px] md:text-xs tracking-[0.5em] rounded-full uppercase font-black w-full sm:w-auto text-center transition-all duration-500" data-discover="true">Schedule a Consult</a>
                </div>
              </div>

            </div>
          </div>

          <!-- Bottom spacing -->
          <div class="h-[40vh]"></div>

        </div>
      </section>

    </div>
  </main>

  <div id="footer-container"></div>
  <script>
    fetch('navbar.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById('navbar-container').innerHTML = html;
      });
    fetch('footer.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById('footer-container').innerHTML = html;
        // Re-init Unicorn Studio so footer social icons render
        if (window.UnicornStudio && window.UnicornStudio.init) {
          window.UnicornStudio.init();
        }
      });
  </script>

  <!-- ==================== FULLSCREEN MODAL ==================== -->
  <div class="gallery-modal" id="gallery-modal">
    <div class="modal-scrim"></div>

    <!-- Close -->
    <button class="modal-close-btn" id="modal-close-btn">
      <span>Close</span>
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </button>

    <!-- Prev / Next Arrows -->
    <button class="modal-nav-btn prev" id="modal-prev" aria-label="Previous service">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
      </svg>
    </button>
    <button class="modal-nav-btn next" id="modal-next" aria-label="Next service">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
      </svg>
    </button>

    <!-- Contained image frame with slide track -->
    <div class="modal-frame" id="modal-frame">
      <!-- Slide track — holds current slide; incoming slides are created dynamically -->
      <div class="modal-slide-track" id="modal-slide-track">
        <div class="modal-slide" id="modal-slide-current">
          <img class="modal-img" id="modal-img" src="" alt="">
        </div>
      </div>
      <div class="modal-img-scrim"></div>
      <div class="modal-text">
        <!-- Title mask: overflow:hidden container. Title words are created dynamically by JS. -->
        <div class="modal-text-mask mb-3 md:mb-4">
          <h2 id="modal-title" class="modal-title-words porsche-font text-3xl md:text-6xl text-white font-bold italic tracking-wide uppercase leading-none drop-shadow-2xl"></h2>
        </div>
        <!-- Description mask -->
        <div class="modal-text-mask">
          <p id="modal-desc" class="text-white/80 text-sm md:text-lg font-light leading-relaxed drop-shadow-lg max-w-lg"></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ═══════════════════════════════════════════════════════════
    // UNICORN TITLE ZOOM — Scroll-Pinned Scale Animation
    // Starts tiny (0.15), scales up to massive (6x) while fading
    // out at the end. Service cards reveal after zoom completes.
    // ═══════════════════════════════════════════════════════════
    window.addEventListener("load", function() {
      gsap.registerPlugin(ScrollTrigger);
      ScrollTrigger.refresh();

      const titleZoomSection = document.getElementById('title-zoom-section');
      const titleZoomInner = document.getElementById('title-zoom-inner');
      const titleZoomFallback = document.getElementById('title-zoom-fallback');
      const galleryGrid = document.getElementById('gallery-grid');
      const galleryCards = document.querySelectorAll('.gallery-card');

      const isMobileDevice = window.innerWidth <= 768;
      // Pick the correct zoom target based on device
      const zoomTarget = isMobileDevice ? titleZoomFallback : titleZoomInner;

      if (titleZoomSection && zoomTarget) {

        // Set initial state for cards — hidden, shifted down
        gsap.set(galleryCards, { y: 100, opacity: 0 });

        // ── Zoom timeline: title scale animation ──
        const zoomTl = gsap.timeline({
          scrollTrigger: {
            trigger: titleZoomSection,
            start: "top top",
            end: "bottom top",
            scrub: isMobileDevice ? 0.6 : true,
            pin: false, // CSS sticky handles pinning
          }
        });

        if (isMobileDevice) {
          // Mobile: lighter scale animation with CSS fallback
          zoomTl.fromTo(zoomTarget,
            { scale: 0.5, opacity: 0, transformOrigin: "center center" },
            { scale: 1.2, opacity: 1, ease: "power2.inOut", duration: 0.4, force3D: true }
          );
          zoomTl.to(zoomTarget,
            { scale: 1.2, duration: 0.15, ease: "none" }
          );
          zoomTl.to(zoomTarget,
            { scale: 2.5, opacity: 0, ease: "power2.in", duration: 0.45, force3D: true }
          );
        } else {
          // Desktop: clip-path reveal — NO scaling, so the Unicorn Studio
          // WebGL canvas renders at full native resolution the entire time.
          // Phase 1: Circle expands from 0% → 75% revealing the embed
          zoomTl.fromTo(zoomTarget,
            { clipPath: "circle(0% at 50% 50%)", opacity: 0 },
            { clipPath: "circle(5% at 50% 50%)", opacity: 1, ease: "power2.out", duration: 0.1 }
          );
          zoomTl.to(zoomTarget,
            { clipPath: "circle(75% at 50% 50%)", ease: "power2.inOut", duration: 0.35 }
          );
          // Phase 2: Hold fully visible
          zoomTl.to(zoomTarget,
            { clipPath: "circle(75% at 50% 50%)", duration: 0.15, ease: "none" }
          );
          // Phase 3: Expand to 150% and fade out (zoom-past effect)
          zoomTl.to(zoomTarget,
            { clipPath: "circle(150% at 50% 50%)", opacity: 0, ease: "power1.in", duration: 0.4 }
          );
        }

        // ── Cards reveal: triggered when the gallery grid scrolls into view ──
        gsap.to(galleryCards, {
          y: 0,
          opacity: 1,
          duration: 1,
          stagger: 0.15,
          ease: "power3.out",
          scrollTrigger: {
            trigger: galleryGrid,
            start: "top 85%",
            toggleActions: "play none none reverse"
          }
        });
      }

      setTimeout(() => ScrollTrigger.refresh(), 500);
    });
  </script>

  <!-- ═══════════════════════════════════════════
       PARALLAX CTA — Background & Floating Text
       ═══════════════════════════════════════════ -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      gsap.registerPlugin(ScrollTrigger);

      const svcCtaSection = document.getElementById('svc-parallax-cta');
      const svcParallaxBg = document.getElementById('svc-parallax-bg');

      if (svcCtaSection && svcParallaxBg) {
        // Background slow-motion parallax (moves ~30% of scroll speed)
        gsap.to(svcParallaxBg, {
          yPercent: -15,
          ease: 'none',
          scrollTrigger: {
            trigger: svcCtaSection,
            start: 'top bottom',
            end: 'bottom top',
            scrub: 0.6,
          }
        });

        // Floating text elements — each moves at a different rate for layered depth
        document.querySelectorAll('.svc-parallax-float').forEach(el => {
          const speed = parseFloat(el.dataset.speed) || 1;
          gsap.to(el, {
            y: () => -80 * speed,
            ease: 'none',
            scrollTrigger: {
              trigger: svcCtaSection,
              start: 'top bottom',
              end: 'bottom top',
              scrub: 0.5,
            }
          });
        });

        // Staggered content reveal animations
        const svcCtaTl = gsap.timeline({
          scrollTrigger: {
            trigger: svcCtaSection,
            start: 'top 40%',
            toggleActions: 'play none none none',
          }
        });

        svcCtaTl
          .to('#svc-cta-eyebrow', { opacity: 1, y: 0, duration: 0.8, ease: 'power3.out' })
          .to('#svc-cta-headline-1', { opacity: 1, y: 0, duration: 0.9, ease: 'power3.out' }, '-=0.5')
          .to('#svc-cta-headline-2', { opacity: 1, y: 0, duration: 0.9, ease: 'power3.out' }, '-=0.6')
          .to('#svc-cta-divider', { opacity: 1, scaleX: 1, duration: 0.6, ease: 'power2.inOut' }, '-=0.4')
          .to('#svc-cta-body', { opacity: 1, y: 0, duration: 0.8, ease: 'power3.out' }, '-=0.3')
          .to('#svc-cta-buttons', { opacity: 1, y: 0, duration: 0.8, ease: 'power3.out' }, '-=0.4');
      }
    });
  </script>

  <script>
    /* ==================================================================
       GALLERY CONTROLLER — FLIP Open + Horizontal Carousel
       ──────────────────────────────────────────────────────
       OPENING: FLIP expansion (700ms) with staggered content cascade.
       CAROUSEL: Horizontal slide (800ms), image parallax, staggered
                 text lifecycle, nav-button dimming.
       Easing: ExpoOut = cubic-bezier(0.16, 1, 0.3, 1)
       ================================================================== */
    (function () {
      'use strict';

      // ── Easing constants ──
      const EASE_OPEN  = 'power3.out';                           // opening FLIP
      const OPEN_DUR   = 0.7;   // 700ms opening

      // ── Carousel physics ──
      // Masked Parallax Transition — "Sliding Window"
      // Duration: 900ms. Easing: cubic-bezier(0.16, 1, 0.3, 1) (ExpoOut)
      // Starts fast, lands very gently — the "luxury" feel.
      const SLIDE_DUR  = 0.9;
      const CAROUSEL_EASE = 'expo.out';
      const IMG_PARALLAX_OFFSET = 25; // % — image counter-movement (the "drag")
      const IMG_SCALE = 1.1;          // resting scale — provides overflow for parallax

      const servicesData = [
        {
          title: 'Paint Protection Film.',
          img: 'https://ogautocc.com/ElevatedWraps/Paint_Protection_Film.jpg',
          desc: "Protect and enhance your vehicle with PPF wraps available in gloss, satin, track film, and custom colors or patterns. Shields against scratches, chips, and paint damage.",
          link: 'PPFPage.html'
        },
        {
          title: 'Vinyl Wraps.',
          img: 'https://ogautocc.com/ElevatedWraps/Vinyl_wraps.jpg',
          desc: "Transform your vehicle with vinyl wraps in custom colors, finishes, and designs. From accents to full body wraps, the options are endless.",
          link: 'wraps.html'
        },
        {
          title: 'Window Tint.',
          img: 'https://ogautocc.com/ElevatedWraps/Window_tint.JPG',
          desc: "Ride in style and comfort with our premium window tint. Choose from a range of shades that reduce glare, block UV rays, and protect your interior.",
          link: 'quote.html'
        },
        {
          title: 'Auto Detail.',
          img: 'https://ogautocc.com/ElevatedWraps/Auto_Detail.jpg',
          desc: "Refresh your vehicle inside and out with our premium detailing service. Restore shine, protect surfaces, and hit the road looking your best.",
          link: 'quote.html'
        }
      ];

      // ── DOM ──
      const cards      = document.querySelectorAll('.gallery-card');
      const modal      = document.getElementById('gallery-modal');
      const scrim      = modal.querySelector('.modal-scrim');
      const modalFrame = document.getElementById('modal-frame');
      const slideTrack = document.getElementById('modal-slide-track');
      let   currentSlide = document.getElementById('modal-slide-current');
      let   modalImg   = document.getElementById('modal-img');
      const imgScrim   = modalFrame.querySelector('.modal-img-scrim');
      const modalTitle = document.getElementById('modal-title');
      const modalDesc  = document.getElementById('modal-desc');
      const closeBtn   = document.getElementById('modal-close-btn');
      const prevBtn    = document.getElementById('modal-prev');
      const nextBtn    = document.getElementById('modal-next');
      const navBtns    = [prevBtn, nextBtn];
      const uiElements = [closeBtn, prevBtn, nextBtn];

      let currentIndex = 0;
      let isOpen = false;
      let isAnimating = false;
      let openTimeline = null;
      const isTouchDevice = ('ontouchstart' in window) || navigator.maxTouchPoints > 0;

      // ── Text reveal — "Angled Pocket Reveal" ──
      // Easing: cubic-bezier(0.22, 1, 0.36, 1) — quintic snap + glide
      // GSAP's 'power4.out' is the closest built-in match.
      const TEXT_EASE = 'power4.out';
      const TEXT_DUR  = 0.85;  // 850ms per element
      const WORD_STAGGER = 0.05; // 50ms between each title word
      const DESC_DELAY   = 0.15; // 150ms after title starts — "chasing"

      // ══════════════════════════════════════════════════════════════
      // TEXT HELPERS — 3D Masked Skew-Transform ("Angled Pocket")
      // ══════════════════════════════════════════════════════════════
      //
      //  THE ANATOMY:
      //   1. Origin:   transform-origin: center bottom → hinged at base
      //   2. Skew:     skewY(7deg) → right side higher than left (the angle)
      //   3. Rotation: rotateX(-30deg) → tilted away from viewer into screen
      //   4. Position: translateY(120%) → hidden below the overflow:clip mask
      //
      //  As the text "swings" up, all three properties resolve to 0 —
      //  the text flattens, straightens, and lands in position.
      //  The word-stagger creates a ripple effect across the headline.
      //

      /**
       * populateTitle(text)
       * Splits the title into individual <span> words for staggering.
       */
      function populateTitle(text) {
        modalTitle.innerHTML = '';
        text.split(/\s+/).forEach(word => {
          const span = document.createElement('span');
          span.className = 'modal-title-word';
          span.textContent = word;
          modalTitle.appendChild(span);
        });
      }

      /**
       * revealText(timeline, startTime)
       * Angled Pocket Reveal: words swing up from below their masks,
       * skewed and tilted, resolving to flat rest. Description follows.
       */
      function revealText(timeline, startTime) {
        const words = modalTitle.querySelectorAll('.modal-title-word');

        // Initial hidden state — below mask, tilted back, skewed
        gsap.set(words, {
          yPercent: 130,
          rotateX: -40,
          skewY: 8,
          scaleY: 0.9,
          opacity: 0,
          transformOrigin: 'center bottom',
          force3D: true
        });
        gsap.set(modalDesc, {
          yPercent: 130,
          rotateX: -35,
          skewY: 5,
          opacity: 0,
          transformOrigin: 'center bottom',
          force3D: true
        });

        // Title words — staggered "swinging hinge" reveal
        timeline.to(words, {
          yPercent: 0,
          rotateX: 0,
          skewY: 0,
          scaleY: 1,
          opacity: 1,
          duration: TEXT_DUR,
          ease: TEXT_EASE,
          stagger: WORD_STAGGER,
          force3D: true
        }, startTime);

        // Description — follows 150ms later, same hinge motion
        timeline.to(modalDesc, {
          yPercent: 0,
          rotateX: 0,
          skewY: 0,
          opacity: 1,
          duration: TEXT_DUR,
          ease: TEXT_EASE,
          force3D: true
        }, startTime + DESC_DELAY);
      }

      /**
       * hideText(timeline, startTime, directionX)
       * Reverse: text swings back into the pocket — tilts forward,
       * skews, and drops below the mask. Optional horizontal drift
       * for carousel directional exit.
       */
      function hideText(timeline, startTime, directionX) {
        const words = modalTitle.querySelectorAll('.modal-title-word');
        const xShift = directionX || 0;

        timeline.to(words, {
          yPercent: -110,
          rotateX: 25,
          skewY: -6,
          scaleY: 0.9,
          x: xShift,
          opacity: 0,
          duration: 0.28,
          ease: 'power3.in',
          stagger: 0.02,
          transformOrigin: 'center top',
          force3D: true
        }, startTime);

        timeline.to(modalDesc, {
          yPercent: -110,
          rotateX: 25,
          skewY: -5,
          x: xShift,
          opacity: 0,
          duration: 0.28,
          ease: 'power3.in',
          transformOrigin: 'center top',
          force3D: true
        }, startTime + 0.04);
      }

      // ── 1. MOUSE-FOLLOW PARALLAX (desktop only) ──
      // Uses GSAP .quickTo() for 60fps interpolated movement
      // that doesn't conflict with ScrollTrigger entrance animations.
      if (!isTouchDevice) {
        cards.forEach(card => {
          const img = card.querySelector('.card-img');
          const xTo = gsap.quickTo(img, 'x', { duration: 0.4, ease: 'power2.out' });
          const yTo = gsap.quickTo(img, 'y', { duration: 0.4, ease: 'power2.out' });

          card.addEventListener('mousemove', (e) => {
            const rect = card.getBoundingClientRect();
            const xNorm = ((e.clientX - rect.left) / rect.width - 0.5) * 2;
            const yNorm = ((e.clientY - rect.top)  / rect.height - 0.5) * 2;
            xTo(-xNorm * 12);
            yTo(-yNorm * 12);
          });
          card.addEventListener('mouseleave', () => {
            xTo(0);
            yTo(0);
          });
        });
      }

      // ── 2. CARD SCROLL ENTRANCE ──
      // (Handled by the title-zoom ScrollTrigger onLeave/onEnterBack callbacks)

      // ══════════════════════════════════════════════════════════════
      // 3. OPEN — FLIP Expansion (unchanged from previous)
      // ══════════════════════════════════════════════════════════════
      function openModal(index) {
        if (isOpen || isAnimating) return;
        isAnimating = true;
        isOpen = true;
        currentIndex = index;
        populateModal(currentIndex);

        const card = cards[index];
        const cardRect = card.getBoundingClientRect();

        modal.classList.add('is-open');
        document.body.style.overflow = 'hidden';

        // Reset everything
        gsap.set(scrim, { opacity: 0 });
        gsap.set(imgScrim, { opacity: 0 });
        gsap.set(uiElements, { opacity: 0 });
        gsap.set(currentSlide, { x: 0, xPercent: 0, opacity: 1 });
        gsap.set(modalImg, { x: 0, xPercent: 0, scale: IMG_SCALE });

        const frameRect = modalFrame.getBoundingClientRect();
        const scaleX = cardRect.width / frameRect.width;
        const scaleY = cardRect.height / frameRect.height;
        const dx = (cardRect.left + cardRect.width / 2) - (frameRect.left + frameRect.width / 2);
        const dy = (cardRect.top + cardRect.height / 2) - (frameRect.top + frameRect.height / 2);

        openTimeline = gsap.timeline({ onComplete: () => { isAnimating = false; } });

        openTimeline.fromTo(modalFrame,
          { x: dx, y: dy, scaleX, scaleY, opacity: 1, borderRadius: '1.25rem', transformOrigin: 'center center' },
          { x: 0, y: 0, scaleX: 1, scaleY: 1, borderRadius: '0.75rem', opacity: 1,
            duration: OPEN_DUR, ease: 'back.out(1.2)', force3D: true },
          0
        );
        openTimeline.to(scrim, { opacity: 1, duration: OPEN_DUR, ease: EASE_OPEN }, 0);
        openTimeline.to(imgScrim, { opacity: 1, duration: 0.4, ease: EASE_OPEN }, 0.2);

        // Text reveal — starts 400ms after expansion begins
        revealText(openTimeline, 0.4);

        openTimeline.to(uiElements, { opacity: 1, duration: 0.3, ease: EASE_OPEN, stagger: 0.05 }, 0.6);
      }

      // ══════════════════════════════════════════════════════════════
      // 4. CLOSE — Reverse FLIP
      // ══════════════════════════════════════════════════════════════
      function closeModal() {
        if (!isOpen || isAnimating) return;
        isAnimating = true;
        if (openTimeline) openTimeline.kill();

        const closeTl = gsap.timeline({
          onComplete: () => {
            modal.classList.remove('is-open');
            gsap.set(modalFrame, { clearProps: 'all' });
            gsap.set(scrim, { clearProps: 'all' });
            gsap.set(imgScrim, { clearProps: 'all' });
            gsap.set(uiElements, { clearProps: 'opacity' });
            gsap.set(currentSlide, { clearProps: 'all' });
            gsap.set(modalImg, { clearProps: 'all' });
            document.body.style.overflow = '';
            isOpen = false;
            isAnimating = false;
          }
        });

        closeTl.to(uiElements, { opacity: 0, duration: 0.15, ease: 'power2.in' }, 0);
        hideText(closeTl, 0, 0);
        closeTl.to(imgScrim, { opacity: 0, duration: 0.2, ease: 'power2.in' }, 0);

        const card = cards[currentIndex];
        const cardRect = card.getBoundingClientRect();
        const frameRect = modalFrame.getBoundingClientRect();
        const scaleX = cardRect.width / frameRect.width;
        const scaleY = cardRect.height / frameRect.height;
        const dx2 = (cardRect.left + cardRect.width / 2) - (frameRect.left + frameRect.width / 2);
        const dy2 = (cardRect.top + cardRect.height / 2) - (frameRect.top + frameRect.height / 2);

        closeTl.to(modalFrame, {
          x: dx2, y: dy2, scaleX, scaleY, borderRadius: '1.25rem', opacity: 0.4,
          duration: 0.5, ease: 'power3.inOut', force3D: true
        }, 0.15);
        closeTl.to(scrim, { opacity: 0, duration: 0.5, ease: 'power3.inOut' }, 0.15);
      }

      // ══════════════════════════════════════════════════════════════
      // 5. CAROUSEL — Masked Parallax Transition ("Sliding Window")
      // ══════════════════════════════════════════════════════════════
      //
      // Two layers move in the SAME direction at DIFFERENT speeds.
      // This creates the illusion of depth — like looking through
      // a moving window at a world that stays put.
      //
      //  ┌─── THE FRAME (overflow: hidden mask) ──────────────────┐
      //  │ Travels 100% of the viewport.                          │
      //  │ This is the hard "wipe" edge you see.                  │
      //  └────────────────────────────────────────────────────────-┘
      //  ┌─── THE IMAGE (110% scaled, inside the frame) ─────────┐
      //  │ Travels only 25% — moves SLOWER than the frame.        │
      //  │ Offset is OPPOSITE to the frame's direction.           │
      //  │ → Frame goes LEFT, image shifts RIGHT inside it.       │
      //  │ This makes the product feel "behind the glass".        │
      //  └────────────────────────────────────────────────────────-┘
      //
      //  NEXT (direction = +1):
      //    Outgoing frame:  xPercent 0 → −100%   (exits left)
      //    Outgoing image:  xPercent 0 → +25%    (lingers right — "stays behind")
      //    Incoming frame:  xPercent +100% → 0    (enters from right)
      //    Incoming image:  xPercent +25% → 0     (drags right → settles center)
      //
      //  PREV (direction = −1):
      //    Outgoing frame:  xPercent 0 → +100%   (exits right)
      //    Outgoing image:  xPercent 0 → −25%    (lingers left)
      //    Incoming frame:  xPercent −100% → 0    (enters from left)
      //    Incoming image:  xPercent −25% → 0     (drags left → settles center)
      //
      //  BRIGHTNESS: Incoming image starts at filter brightness(0.8)
      //    and warms to brightness(1.0) — simulates entering the light.
      //
      //  SCALE: Outgoing image 1.1 → 1.0 (recedes).
      //         Incoming image 1.0 → 1.1 (approaches, settles at rest).
      //
      //  OPACITY: Incoming slide 0 → 1 (fast). Outgoing stays 1.
      //
      //  TEXT: Exits at 0ms (280ms). Re-enters at 400ms staggered.
      //
      //  900ms, cubic-bezier(0.16, 1, 0.3, 1) — fast flick, long weighted landing.
      //
      function navigateTo(direction) {
        if (isAnimating) return;
        isAnimating = true;

        // ── Dim nav buttons ──
        navBtns.forEach(btn => btn.classList.add('is-transitioning'));

        // Calculate next index
        const nextIndex = (currentIndex + direction + servicesData.length) % servicesData.length;
        const nextItem = servicesData[nextIndex];

        // ── Create incoming slide ──
        const incomingSlide = document.createElement('div');
        incomingSlide.className = 'modal-slide';
        const incomingImg = document.createElement('img');
        incomingImg.className = 'modal-img';
        incomingImg.src = nextItem.img;
        incomingImg.alt = nextItem.title;
        incomingSlide.appendChild(incomingImg);
        slideTrack.appendChild(incomingSlide);

        // ── Direction vectors ──
        const exitX  = direction * -100;  // frame exit direction
        const enterX = direction * 100;   // frame enter direction

        // ── Initial state: incoming ──
        gsap.set(incomingSlide, { xPercent: enterX, opacity: 0 });
        gsap.set(incomingImg, {
          // Image offset is in the SAME direction as frame entry.
          // Frame enters from +100%, image starts at +25% inside it.
          // As the frame moves left to 0%, the image also moves left
          // but only 25% — so the image is SLOWER → depth.
          xPercent: direction * IMG_PARALLAX_OFFSET,
          scale: 1.0,
          filter: 'brightness(0.8)',
          force3D: true
        });

        // ── Reference to exiting image ──
        const currentImg = currentSlide.querySelector('.modal-img');

        // ── Master timeline ──
        const tl = gsap.timeline({
          defaults: { ease: CAROUSEL_EASE, force3D: true },
          onComplete: () => {
            // Swap DOM: incoming becomes current
            currentSlide.remove();
            incomingSlide.id = 'modal-slide-current';
            currentSlide = incomingSlide;
            modalImg = incomingSlide.querySelector('.modal-img');
            modalImg.id = 'modal-img';
            currentIndex = nextIndex;

            // Clean up filter
            gsap.set(modalImg, { filter: 'none' });

            // Un-dim nav
            navBtns.forEach(btn => btn.classList.remove('is-transitioning'));
            isAnimating = false;
          }
        });

        // ──────────────────────────────────────────────────
        //  TEXT EXIT — masked slide up + directional drift
        // ──────────────────────────────────────────────────
        hideText(tl, 0, direction * -20);

        // ──────────────────────────────────────────────────
        //  OUTGOING FRAME — wipes off-screen
        // ──────────────────────────────────────────────────
        tl.to(currentSlide, {
          xPercent: exitX,   // 0 → −100% (next) or 0 → +100% (prev)
          duration: SLIDE_DUR
        }, 0);

        // ──────────────────────────────────────────────────
        //  OUTGOING IMAGE — "lingers" in the opposite direction
        //  Frame goes left, image drifts RIGHT inside it.
        //  This makes the product appear to "stay behind" for
        //  a split second before the frame wipes it away.
        // ──────────────────────────────────────────────────
        tl.to(currentImg, {
          // direction=+1: frame exits LEFT, image drifts to +25% (RIGHT)
          // direction=-1: frame exits RIGHT, image drifts to -25% (LEFT)
          xPercent: direction * IMG_PARALLAX_OFFSET,
          scale: 1.0,          // subtle shrink from resting 1.1
          duration: SLIDE_DUR
        }, 0);

        // ──────────────────────────────────────────────────
        //  INCOMING FRAME — enters from off-screen
        //  Opacity blends 0 → 1 quickly to smooth the "hit"
        // ──────────────────────────────────────────────────
        tl.to(incomingSlide, {
          xPercent: 0,       // +100% → 0 (next) or −100% → 0 (prev)
          opacity: 1,
          duration: SLIDE_DUR
        }, 0);

        // ──────────────────────────────────────────────────
        //  INCOMING IMAGE — the "drag" parallax
        //  Starts shifted in the direction of entry (+25%),
        //  glides to center (0%). Travels 25% while its
        //  frame travels 100% → the image moves SLOWER →
        //  it looks like a world behind the window.
        //  Also scales 1.0 → 1.1 and brightens 0.8 → 1.0.
        // ──────────────────────────────────────────────────
        tl.to(incomingImg, {
          xPercent: 0,
          scale: IMG_SCALE,    // 1.0 → 1.1 subtle zoom into rest
          filter: 'brightness(1)',
          duration: SLIDE_DUR
        }, 0);

        // ──────────────────────────────────────────────────
        //  TEXT ENTRANCE — "Angled Pocket Reveal" 3D masked reveal
        //  Populate new content, split title into words,
        //  then animate them in. Must be done inside a callback
        //  so the .modal-title-word spans exist in the DOM before
        //  GSAP tries to animate them.
        // ──────────────────────────────────────────────────
        tl.add(() => {
          populateTitle(nextItem.title);
          modalDesc.textContent = nextItem.desc;

          const freshWords = modalTitle.querySelectorAll('.modal-title-word');

          // Set initial hidden state for title words
          gsap.set(freshWords, {
            yPercent: 130,
            rotateX: -40,
            skewY: 8,
            scaleY: 0.9,
            opacity: 0,
            transformOrigin: 'center bottom',
            force3D: true
          });
          // Set initial hidden state for description
          gsap.set(modalDesc, {
            yPercent: 130,
            rotateX: -35,
            skewY: 5,
            opacity: 0,
            transformOrigin: 'center bottom',
            force3D: true
          });

          // Animate title words — staggered hinge reveal
          gsap.to(freshWords, {
            yPercent: 0,
            rotateX: 0,
            skewY: 0,
            scaleY: 1,
            opacity: 1,
            duration: TEXT_DUR,
            ease: TEXT_EASE,
            stagger: WORD_STAGGER,
            force3D: true
          });

          // Animate description — follows 150ms later
          gsap.to(modalDesc, {
            yPercent: 0,
            rotateX: 0,
            skewY: 0,
            opacity: 1,
            duration: TEXT_DUR,
            ease: TEXT_EASE,
            delay: DESC_DELAY,
            force3D: true
          });
        }, 0.4);
      }

      // ── 6. POPULATE (initial load only) ──
      function populateModal(index) {
        const item = servicesData[index];
        modalImg.src = item.img;
        populateTitle(item.title);
        modalDesc.textContent = item.desc;
      }

      // ── EVENT LISTENERS ──
      cards.forEach(card => {
        card.addEventListener('click', () => openModal(parseInt(card.dataset.index)));
      });

      closeBtn.addEventListener('click', closeModal);
      prevBtn.addEventListener('click', (e) => { e.stopPropagation(); navigateTo(-1); });
      nextBtn.addEventListener('click', (e) => { e.stopPropagation(); navigateTo(1); });
      modal.querySelector('.modal-scrim').addEventListener('click', closeModal);

      document.addEventListener('keydown', (e) => {
        if (!isOpen) return;
        if (e.key === 'Escape')     closeModal();
        if (e.key === 'ArrowRight') navigateTo(1);
        if (e.key === 'ArrowLeft')  navigateTo(-1);
      });

      let touchStartX = 0;
      modal.addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].screenX; }, { passive: true });
      modal.addEventListener('touchend', (e) => {
        const diff = e.changedTouches[0].screenX - touchStartX;
        if (Math.abs(diff) > 60) navigateTo(diff < 0 ? 1 : -1);
      }, { passive: true });

    })();
  </script>
  <script>
    // GSAP letter-by-letter reveal
    document.addEventListener('DOMContentLoaded', function() {
      gsap.registerPlugin(ScrollTrigger);
      gsap.utils.toArray('.reveal-letters').forEach((el) => {
        const originalHTML = el.innerHTML;
        const allLetters = []; 

        function wrapTextNodes(node) {
          if (node.nodeType === Node.TEXT_NODE) {
            return node.textContent.split('').map(char => {
              const span = document.createElement('span');
              span.textContent = char;
              span.style.opacity = '0';
              allLetters.push(span);
              return span;
            });
          } else if (node.nodeType === Node.ELEMENT_NODE) {
            const clone = node.cloneNode(false);
            Array.from(node.childNodes).forEach(child => {
              const children = wrapTextNodes(child);
              children.forEach(childNode => clone.appendChild(childNode));
            });
            return [clone];
          } else {
            return [];
          }
        }

        const temp = document.createElement('div');
        temp.innerHTML = originalHTML;
        
        const newChildren = [];
        Array.from(temp.childNodes).forEach(node => {
          newChildren.push(...wrapTextNodes(node));
        });
        
        el.innerHTML = '';
        newChildren.forEach(child => el.appendChild(child));
        
        gsap.to(allLetters, {
          opacity: 1,
          stagger: 0.03,
          duration: 0.5,
          ease: 'power1.out',
          scrollTrigger: {
            trigger: el,
            start: "top 85%",
            toggleActions: "play none none reverse"
          }
        });
      });
      
      // Auto-wrap text in buttons for the border gradient effect
      document.querySelectorAll('.btn-solid').forEach(btn => {
         if(!btn.querySelector('span')) {
             const text = btn.innerText;
             btn.innerHTML = `<span class="relative z-10 flex items-center justify-center gap-2">${text}</span>`;
         }
      });
    });
  </script>
</body>
</html>